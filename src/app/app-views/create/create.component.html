<!-- <mat-icon>room</mat-icon> pour icon arret-->
<mat-stepper [orientation]="innerWidth<600?'vertical':'horizontal'" [linear]="isLinear" #stepper>
  <mat-step [stepControl]="firstFormGroup" errorMessage="Info du défi non remplies en totalité">
    <form [formGroup]="firstFormGroup" novalidate>
      <ng-template matStepLabel>Tu veux créer un défi ? C'est parti !</ng-template>

      <!-- Titre du défi -->
      <p>Tu dois donner un titre à ton défi !</p>
      <mat-form-field appearance="fill">
        <mat-label>Titre du défi</mat-label>
        <input matInput placeholder="" formControlName="titre" required>
        <mat-error *ngIf="checkError('titre', 'required')">Le titre doit être renseigné</mat-error>
        <mat-error *ngIf="checkError('titre', 'maxlength')">Le titre est trop longue {{firstFormGroup.controls['titre'].value.length}}/45</mat-error>
        <mat-error *ngIf="checkError('titre', 'minlength')">Le titre est trop courte de {{5-firstFormGroup.controls['titre'].value.length}}</mat-error>
      </mat-form-field>


      <!-- Description -->
      <p>Décris-nous ton défi ?</p>
      <mat-form-field appearance="fill">
        <mat-label>Description du défi</mat-label>
        <textarea matInput placeholder="" formControlName="description" required #description></textarea>
        <mat-error *ngIf="checkError('description', 'required')">La description doit être renseignée</mat-error>
        <mat-error *ngIf="checkError('description', 'maxlength')">La description est trop longue {{firstFormGroup.controls['description'].value.length}}/128</mat-error>
        <mat-error *ngIf="checkError('description', 'minlength')">La description est trop courte de {{10-firstFormGroup.controls['description'].value.length}}</mat-error>
      </mat-form-field>

      <!-- Arret -->
      <div class="step-content-left">
        <p>Choisis l'arrêt dans la Métropole qui servira de point de départ au visiteur pour commencer ton défi</p>
        <mat-form-field appearance="outline">
          <mat-label>Arrêt de départ</mat-label>
          <input #input (input)="(input.value)" matInput
                 placeholder="Chavant, Condillac Université, etc..." formControlName="arret" required>
          <mat-icon matSuffix style="cursor: pointer;">room</mat-icon>
          <mat-error *ngIf="checkError('arret', 'required')">L'arrêt doit être renseigné</mat-error>
        </mat-form-field>
      </div>

      <!-- Duree du défi -->
      <p>Combien de temps estimes-tu nécessaire
        e pour effectuer ton défi (en minutes) ?</p>
      <mat-form-field appearance="fill">
        <mat-label> Durée du défi</mat-label>
        <input matInput placeholder="Durée du défi" formControlName="duree" type="number" name="duree" min="1" required>
        <mat-error *ngIf="checkError('duree', 'required')">La durée doit être renseignée</mat-error>
        <mat-error *ngIf="checkError('duree', 'min')">La durée doit être d'une minute minimum</mat-error>
      </mat-form-field>

      <!-- on peut faire une methode qui va calculer le nombre total des points à travers les etapes -->
      <!--      <p>Ton défi va nous faire gagner combien de points ? </p>
            <mat-form-field appearance="fill">
              <mat-label> Points du défi </mat-label>
              <input matInput placeholder="Total points " type="number" name="pointDefi" min="1" [(ngModel)]="totalPoints"
                     required>
              <mat-error *ngIf="checkError('pointDefi', 'requiered')">Le total de point doit être renseignée</mat-error>
            </mat-form-field>-->

      <!-- Tags -->

      <div class="step-content-left mots-cles">
        <mat-form-field appearance="outline">
          <mat-label>Mot-clés du défi</mat-label>
          <mat-chip-list #chipList aria-label="Mot Clés">
            <mat-chip *ngFor="let item of listeTags" selectable removable (removed)="remove(item)">
              {{item}}
              <mat-icon matChipRemove>cancel</mat-icon>
            </mat-chip>
            <input pattern="[a-zA-Z ]*" name="tags" placeholder="Decouverte, StreetArt , etc..."
                   [matChipInputFor]="chipList"
                   [matChipInputSeparatorKeyCodes]="separatorKeysCodes" matChipInputAddOnBlur
                   (matChipInputTokenEnd)="add($event)">
          </mat-chip-list>
        </mat-form-field>
      </div>
      <div>
        <button mat-button matStepperNext>Suivant</button>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="secondFormGroup" errorMessage="Info des étapes non remplie en totalité">
    <form [formGroup]="secondFormGroup">
      <p>Dans notre communauté, une étape peut être une indication ou une tache à faire ! Combien d'étapes contient ton
        défi ?</p>
      <ng-template matStepLabel>Les étapes du défi</ng-template>
      <mat-form-field appearance="fill">
        <!-- Creation des étapes -->
        <mat-label>Nombre d'étapes</mat-label>
        <input matInput type="number" placeholder="Nombre d'etapes" formControlName="nbEtapes" min="1" max="99" required/>
        <mat-error *ngIf="checkError2('nbEtapes', 'required')">Le nombre d'etapes doit être renseignée</mat-error>
        <mat-error *ngIf="checkError2('nbEtapes', 'min')">Le nombre d'etapes doit être d'une étape minimum</mat-error>
        <mat-error *ngIf="checkError2('nbEtapes', 'max')">Le nombre d'etapes doit être de 99 étape maximum</mat-error>
      </mat-form-field>
      <mat-accordion *ngIf="!secondFormGroup.controls['nbEtapes'].invalid">
        <mat-expansion-panel *ngFor="let e of [].constructor(secondFormGroup.controls['nbEtapes'].value);let num = index;">
          <mat-expansion-panel-header>
            <mat-panel-title>
              Etape {{num + 1}}
            </mat-panel-title>
            <mat-panel-description *ngIf="checkEtapeErrors(num)">
              Attention, il y a des erreurs dans cette étape
              <mat-icon color="warn" >error</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>
          <div>
            <app-create-etape (group)="addForm($event,num)" #error></app-create-etape>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
      <div>
        <button mat-button matStepperPrevious>Retour</button>
        <button mat-button matStepperNext>Suivant</button>
      </div>
    </form>
  </mat-step>
  <mat-step>
    <form (ngSubmit)="openSnackBar()">
      <ng-template matStepLabel>On arrive à la fin !</ng-template>
      <!--<button mat-stroked-button (click)="openSnackBar(messageFi,action)">Créer mon défi</button>-->

      <br>
      <!-- Modification de ce qu'on a fait -->
      <div>
        <p class="TextModifierDefi"> Tu as changé d'avis ?
        <p>
        <p>Tu peux encore le modifier</p>
        <button mat-icon-button matStepperPrevious color="warn" aria-label="Example icon button with a home icon">
          Modifier le défi
          <mat-icon>update</mat-icon>
        </button>
      </div>

      <br>

      <div>
        <button mat-icon-button color="primary" aria-label="Example icon button with a home icon"
                [disabled]="firstFormGroup.invalid || firstFormGroup.pristine || secondFormGroup.invalid || secondFormGroup.pristine"
                type="submit">
          Créer le défi
          <mat-icon>task_alt</mat-icon>
        </button>
      </div>
    </form>
  </mat-step>
</mat-stepper>

